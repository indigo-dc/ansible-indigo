---
- name: Install software-properties-common (Debian systems)
  apt:
    name: software-properties-common
    state: latest

- name: Install OpenStack cloud-archive ppa (Debian distros)
  command: "add-apt-repository -y cloud-archive:newton"
  when: enable_openstack_distro_repo

- apt_key:
    url: "http://repo.indigo-datacloud.eu/repository/RPM-GPG-KEY-indigodc"
    state: present

- name: Add INDIGO base APT repository
  apt_repository:
    repo: "deb [arch=amd64] http://repo.indigo-datacloud.eu/repository/indigo/{{ indigo_release }}/ubuntu/ xenial main third-party"
    state: present
    filename: indigo

- name: Add INDIGO updates APT repository
  apt_repository:
    repo: "deb [arch=amd64] http://repo.indigo-datacloud.eu/repository/indigo/{{ indigo_release}}/ubuntu/ xenial-updates main third-party"
    state: present
    filename: indigo

- name: Add INDIGO-testing base APT repository
  apt_repository:
    repo: "deb [arch=amd64] http://repo.indigo-datacloud.eu/repository/indigo-testing/{{ indigo_release}}/ubuntu/ xenial main third-party"
    state: present
    filename: indigo-testing
  when: enable_testing_repo

- name: Add INDIGO-testing updates APT repository
  apt_repository:
    repo: "deb [arch=amd64] http://repo.indigo-datacloud.eu/repository/indigo-testing/{{ indigo_release}}/ubuntu/ xenial-updates main third-party"
    state: present
    filename: indigo-testing
  when: enable_testing_repo

- name: Add INDIGO-preview base APT repository
  apt_repository:
    repo: "deb [arch=amd64] http://repo.indigo-datacloud.eu/repository/indigo-preview/{{ indigo_release}}/ubuntu/ xenial main third-party"
    state: present
    filename: indigo-preview
  when: enable_preview_repo

- name: Add INDIGO-preview updates APT repository
  apt_repository:
    repo: "deb [arch=amd64] http://repo.indigo-datacloud.eu/repository/indigo-preview/{{ indigo_release}}/ubuntu/ xenial-updates main third-party"
    state: present
    filename: indigo-preview
  when: enable_preview_repo
